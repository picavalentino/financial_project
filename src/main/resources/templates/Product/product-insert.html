<!DOCTYPE html>
<html xmlns:th="www.thymeleaf.org" xmlns:layout="www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/layout}">
<!--security 적용 후 아래 코드로 변경해주세요-->
<!--<html xmlns:th="www.thymeleaf.org" xmlns:layout="www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/layout}" xmlns:sec="www.thymeleaf.org/extras/spring-security">-->

<meta charset="UTF-8">
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/css/product/bootstrap.css">
    <link rel="stylesheet" href="/css/product/common.css">
    <link rel="stylesheet" href="/css/product/product-insert.css">
    <link rel="stylesheet" href="/css/buttons/button.css">
</head>

<title>GS Bank</title>
<!-- 전체 적용될 CSS -->
<th:block layout:fragment="css"></th:block>
<!-- 전체 적용될 스크립트 -->
<th:block layout:fragment="script"></th:block>

<!-- 우리가 작업할 공간 -->
<body>
<div layout:fragment="content" class="content">
        <div class="sub_content">
            <div class="location">
                <a th:href="@{/main}"><i class="bi bi-house-door-fill"></i> Home</a>
                <a th:href="@{/product/list}"> / 상품관리</a>
                <p> / 신규상품등록</p>
            </div>
            <div class="produce">
                <h1 class="title">신규상품등록</h1>
                <div class="box_wrap">
                    <form th:action="@{/product/insert/}" method="post" class="product-info" id="product-form">
                        <table class="table-product-form">
                            <tbody>
                            <tr>
                                <th><label>상품명</label></th>
                                <td><input name="prodNm" type="text"></td>
                            </tr>
                            <tr>
                                <th><label>상품유형</label></th>
                                <td>
                                    <select name="prodTyCd">
                                        <option value="1">적금</option>
                                        <option value="2">예금</option>
                                        <option value="3">대출</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <th><label>가입대상</label></th>
                                <td>
                                    <select name="prodSbstgTyCd">
                                        <option value="1">일반개인</option>
                                        <option value="2">청년생활지원</option>
                                        <option value="3">장애자우선지원</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <th><label>가입금액</label></th>
                                <td>
                                    <div class="inp_wrap">
                                        <input name="prodInstlAmtMin" type="text" placeholder="최소">
                                        <span>~</span>
                                        <input name="prodInstlAmtMax" type="text" placeholder="최대">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th><label>납입주기</label></th>
                                <td>
                                    <select name="prodPayTyCd">
                                        <option value="1">월납</option>
                                        <option value="3">3개월납</option>
                                        <option value="6">6개월납</option>
                                        <option value="8">년납</option>
                                        <option value="9">일시납</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <th><label>적용이율</label></th>
                                <td>
                                    <div class="inp_wrap">
                                        <input name="prodAirMin" type="text" placeholder="최소">
                                        <span>~</span>
                                        <input name="prodAirMax" type="text" placeholder="최대">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th><label>적용기간</label></th>
                                <td>
                                    <div class="inp_wrap">
                                        <input name="prodAirBgnYmd" type="date" required>
                                        <span>~</span>
                                        <input name="prodAirEndYmd" type="date" required>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th><label>이자과세구분</label></th>
                                <td>
                                    <select name="prodIntTaxTyCd">
                                        <option value="1">일반과세</option>
                                        <option value="2">세금우대</option>
                                        <option value="3">비과세</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <th><label>판매상태</label></th>
                                <td>
                                    <select name="prodCurrStcd">
                                        <option value="0">판매대기</option>
                                        <option value="1">판매중</option>
                                        <option value="2">판매중지</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <th><label>판매기간</label></th>
                                <td>
                                    <div class="inp_wrap">
                                        <input name="prodNtslBgnYmd" type="date" required>
                                        <span>~</span>
                                        <input name="prodNtslEndYmd" type="date" required>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th>담당직원</th>
                                <td><input type="text"></td>
                            </tr>
                            </tbody>
                        </table>
                    </form>
                </div>
            </div>
            <div class="button-wrap">
                <button class="btn btn-register">
                    <i class="icon bi bi-plus-circle-fill"></i> 등록
                </button>
                <button class="btn btn-reset">
                    <i class="icon bi bi-arrow-left-circle-fill"></i> 초기화
                </button>
                <button class="btn btn-list">
                    <i class="icon bi bi-list"></i> 목록
                </button>
            </div>
        </div>

    <script th:inline="javascript">
        $(document).ready(function () {
            // 등록 버튼 클릭
            $(".btn-register").on("click", function (e) {
                e.preventDefault(); // 기본 동작 방지
                const formData = $("form.product-info").serialize(); // 폼 데이터 직렬화
                const insertUrl = "/product/insert" // 등록 요청 URL

                $.ajax({
                    url: insertUrl,
                    type: "POST",
                    data: formData,
                    success: function (response) {
                        alert("신규 상품이 등록되었습니다.");
                        // 성공 시 원하는 동작 추가 (예: 상세 페이지 새로고침)
                        window.location.href = "/product/list"; // 목록 페이지로 이동
                    },
                    error: function (xhr, status, error) {
                        console.error("등록 실패: ", error);
                        alert("상품 등록에 실패했습니다.");
                    },
                });
            });

            // 초기화 버튼 클릭
            $(".btn-reset").on("click", function (e) {
                e.preventDefault(); // 기본 동작 방지
                document.getElementById("product-form").reset(); // 폼 초기화
            });

            // 목록 버튼 클릭
            $(".btn-list").on("click", function (e) {
                e.preventDefault(); // 기본 동작 방지
                window.location.href = "/product/list"; // 목록 페이지로 이동
            });
        });
    </script>
</div>
</body>
</html>